@model PriceRangeFilterModel

<script asp-exclude-from-bundle="true" src="~/lib_npm/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js" asp-location="Footer"></script>

<div class="mt-shop-widget mb-50 mt-price-box">
    <h3 class="mt-shop-widget-title no-border">@T("Filtering.PriceRangeFilter")</h3>

    <div class="mt-shop-widget-content">
        <div class="mt-shop-widget-filter">
            <div id="price-range-slider" class="mb-10"></div>
            <div class="mt-shop-widget-filter-info d-flex align-items-center justify-content-between">
                <span class="input-range">
                    <input type="text" id="amount" readonly>
                </span>
                
            </div>
        </div>
    </div>
</div>
<script asp-location="Footer">
    $(function() {
        var $priceRangeEl = $("#price-range-slider");
        $priceRangeEl.slider({
            range: true,
            min: @Model.AvailablePriceRange.From,
            max: @Model.AvailablePriceRange.To,
            values: [
                @Model.SelectedPriceRange.From,
                @Model.SelectedPriceRange.To
            ],
            slide: function (event, ui) {
                setSelectedPriceRange(ui.values[0], ui.values[1]);
            },
            stop: function () {
                CatalogProducts.getProducts();
            }
        });

        setSelectedPriceRange(
            $priceRangeEl.slider("values", 0),
            $priceRangeEl.slider("values", 1)
        );

        $(CatalogProducts).on('before', function (e) {
            var priceRange = $priceRangeEl.slider('values');
            if (priceRange && priceRange.length > 0) {
                e.payload.urlBuilder
                    .addParameter('price', priceRange.join('-'));
            }
        });
    });

    function setSelectedPriceRange(from, to) {
           $("#amount").val("$" + from +  " - $" + to); 
    }
</script>
 
